{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\n//: змінна опцій HTTPS запиту\nconst server = axios.create({\n  baseURL: 'https://pixabay.com/api/',\n  params: {\n    key: '53374429-639c77152d70b3fe75f006246',\n    q: '',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n  },\n});\n\n//: ф-я HTTPS запит\nexport async function getImagesByQuery(query, page) {\n  const res = await server.get('', {\n    params: {\n      q: query,\n      page: page,\n      per_page: 15,\n    },\n  });\n\n  return res.data;\n}\n","//: підключення бібліотеки\nimport SimpleLightbox from 'simplelightbox';\nimport Granim from 'granim';\n\n//: пошук елементів DOM\nlet refs = {\n  galleryElem: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  loadMoreBtn: document.querySelector('.js-btn-load'),\n};\nconst { galleryElem, loader, loadMoreBtn } = refs;\n\n//: ф-я темплеуйту розмітки\nfunction imageTemplate({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  let tagsText = tags.split(',').slice(0, 3);\n\n  return `\n  <li class=\"list-item\">\n        <div class=\"item-container\">\n        <a href=\"${largeImageURL}\" class=\"\">\n          <img src=\"${webformatURL}\" alt=\"${tagsText}\" class=\"item-img\">\n          </a>\n          <div class=\"desc-container\">\n            <p class=\"item-title\">Likes <span class=\"item-number\">${likes}</span></p>\n            <p class=\"item-title\">Views <span class=\"item-number\">${views}</span></p>\n            <p class=\"item-title\">Comments <span class=\"item-number\">${comments}</span></p>\n            <p class=\"item-title\">Downloads <span class=\"item-number\">${downloads}</span></p>\n          </div>\n        </div>\n      </li>`;\n}\n\n//: б-ка галереї\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n  overlayOpacity: 0.85,\n});\n\n//: ф-я рендеру розмітки\nexport function createGallery(images) {\n  const markup = images.map(imageTemplate).join('');\n  galleryElem.innerHTML = markup;\n  lightbox.refresh();\n  return markup;\n}\n\nexport function addGallery(images) {\n  const markup = images.map(imageTemplate).join('');\n  galleryElem.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n  return markup;\n}\n\n//: ф-я очистки галереї\nexport function clearGallery() {\n  galleryElem.innerHTML = '';\n}\n\n//: ф-я запуску загрузки\nexport function showLoader() {\n  if (!loader.classList.contains('isActive')) {\n    // hideLoadBtn();\n    loader.classList.add('isActive');\n  }\n}\n\n//: ф-я виключення загрузки\nexport function hideLoader() {\n  if (loader.classList.contains('isActive')) {\n    loader.classList.remove('isActive');\n  }\n}\n\n//: ф-я включення та виключення кнопки load more\nexport function showLoadBtn() {\n  if (loadMoreBtn.classList.contains('hidden')) {\n    loadMoreBtn.classList.remove('hidden');\n  } else {\n    console.log('⚠️ class hidden its alredy  REMOVED ');\n  }\n}\n\nexport function hideLoadBtn() {\n  if (!loadMoreBtn.classList.contains('hidden')) {\n    loadMoreBtn.classList.add('hidden');\n  } else {\n    console.log('⚠️ class hidden its alredy  ADDED');\n  }\n}\n\n//: ф-я стилізації фону\nexport function loadGranim() {\n  let granimInstance = new Granim({\n    element: '#granim-canvas',\n    name: 'granim',\n    opacity: [1, 1],\n    states: {\n      'default-state': {\n        gradients: [\n          ['#834D9B', '#D04ED6'],\n          ['#1CD8D2', '#93EDC7'],\n        ],\n      },\n    },\n  });\n  return;\n}\n","import './scss/main.scss';\nimport iziToast from 'izitoast';\nimport { getImagesByQuery } from './js/pixabay-api';\n\n//: імпорт функцій\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  loadGranim,\n  showLoadBtn,\n  hideLoadBtn,\n  addGallery,\n} from './js/render-functions';\n\n//: пошук DOM елементів\nconst refs = {\n  form: document.querySelector('.form'),\n  loadMoreBtn: document.querySelector('.js-btn-load'),\n};\n\n//: деструктуризація\nconst { form, loadMoreBtn } = refs;\n\n//: Задні фон\ndocument.addEventListener('DOMContentLoaded', () => {\n  loadGranim();\n});\n\nconst PER_PAGE = 15;\nlet page;\nlet query; // виведено для збереження пошуку\nlet totalPages;\n\nlet rect;\n\n//: прослуховувач submit +\nform.addEventListener('submit', async e => {\n  e.preventDefault();\n\n  const formData = new FormData(form);\n\n  query = formData.get('search-text').trim();\n  page = 1;\n\n  if (query === '') {\n    clearGallery();\n    form.reset();\n    return iziToast.show({\n      messageSize: '20',\n      message: `Будь ласка введіть назву фото!`,\n      position: 'center',\n      close: true,\n      closeOnEscape: true,\n      theme: 'light',\n      color: 'yellow',\n    });\n  }\n\n  showLoader();\n  clearGallery();\n  form.reset();\n\n  //: Проміс + async\n\n  try {\n    const res = await getImagesByQuery(query, page);\n\n    if (res.hits.length === 0) {\n      hideLoader();\n      return Promise.reject(reject);\n    }\n    createGallery(res.hits);\n    totalPages = Math.ceil(res.total / PER_PAGE);\n    console.log('Total Pages', totalPages);\n\n    hideLoader();\n    checkBtnStatus();\n  } catch {\n    iziToast.show({\n      messageSize: '20',\n      message: `На жаль, немає зображень, що відповідають вашому пошуковому запиту. Спробуйте ще раз!`,\n      position: 'center',\n      close: true,\n      closeOnEscape: true,\n      theme: 'light',\n      color: 'orange',\n    });\n  }\n});\n\n//: прослуховувач load more btn\nloadMoreBtn.addEventListener('click', async () => {\n  page += 1;\n\n  const listItem = document.querySelector('.list-item');\n  rect = listItem.getBoundingClientRect();\n\n  console.log(listItem);\n\n  console.log(rect);\n\n  showLoader();\n  hideLoadBtn();\n\n  const res = await getImagesByQuery(query, page);\n  addGallery(res.hits);\n\n  hideLoader();\n  checkBtnStatus();\n\n  window.scrollBy({\n    top: rect.height * 3,\n    behavior: 'smooth',\n  });\n});\n\n//: Ф-я перевірки статусу кнопки\nfunction checkBtnStatus() {\n  if (page < totalPages) {\n    showLoadBtn();\n  } else {\n    hideLoadBtn();\n    iziToast.show({\n      messageSize: '20',\n      message: `Вибачте, але ви досягли кінця результатів пошуку.`,\n      position: 'bottomCenter',\n      close: true,\n      closeOnEscape: true,\n      theme: 'light',\n      color: 'white',\n    });\n  }\n}\n"],"names":["server","axios","getImagesByQuery","query","page","refs","galleryElem","loader","loadMoreBtn","imageTemplate","webformatURL","largeImageURL","tags","likes","views","comments","downloads","tagsText","lightbox","SimpleLightbox","createGallery","images","markup","addGallery","clearGallery","showLoader","hideLoader","showLoadBtn","hideLoadBtn","loadGranim","Granim","form","PER_PAGE","totalPages","rect","e","iziToast","res","checkBtnStatus","listItem"],"mappings":"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"}